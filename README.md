# CVE-2012-2982
POC en Python para el CVE-2012-2982 (Webmin 1.580) mejorado del original por el usuario [OstojaOfficial](https://github.com/OstojaOfficial/CVE-2012-2982)

Esta es una versión mejorada del script original que permite al usuario ver el formato de entrada de los datos sin necesidad de ver todo el script para descubrirlo. Para ello, simplemente se movió dicha sección del código al inicio:

![](images/1.png)

A la par, se anexa una instrucción de salida para evitar que el script siga corriendo (sys.exit(1)).

También se agrega la posibilidad de que el usuario pueda incluir el puerto en el cual corre el servicio Webmin 1.580 desde el momento en el que llama al exploit.

![](images/2.png)

Dado que se añadió una nueva entrada, se modifican todos los demás datos, a la par que se modifica la URL de consulta para loguearse y explotar la vulnerabilidad.

![](images/3.png)

Por último, se añade la funcionalidad principal que ejecutará el script en caso de recibir todos los datos correctamente.

![](images/4.png)

NOTA: Recuerda que antes de ejecutar el script debes instalar las librerías requeridas. Para ello, solo escribe en una consola:

`pip3 install -r requirements.txt`

En dado caso de nunca haber usado pip3, este se deberá instalar con el siguiente comando:

`apt install python3-pip`

Si este último comando llega a dar el siguiente error:

![](images/5.png)

Ejecutar el siguiente comando para corregirlo. El error se debe a que no está instalado **ldap** en el sistema.

`apt-get install build-essential python3-dev python2.7-dev \
    libldap2-dev libsasl2-dev slapd ldap-utils tox \
    lcov valgrind`
